```{r}
# Calling package dplyr
library(dplyr)
# Don't delete this chunk if you are using the DataComputing package
library(DataComputing)
library(mosaic)
```

```{r}
loc <- four_incid %>%
  filter(!is.na(LATITUDE_X) & !is.na(LONGITUDE_X))
```
```{r}
summary(loc$LATITUDE_X)
summary(loc$LONGITUDE_X)
```

```{r}
dx = (39.50-34.06)/10 #latitude
dy = (-84.37+85.02)/10 #longitude
```
```{r}
a = c(1:11)
b = c(1:11)
for (i in c(1:11)) {
  a[i] = 39.06+(i-1)*dx
}
for (i in c(1:11)) {
  b[i] = -85.02+(i-1)*dy
}
```

```{r}
small_reg <-
  loc %>%
  mutate(region = derivedFactor(
      "1" = ( a[1] <= LATITUDE_X & LATITUDE_X <= a[2] & b[1] < LONGITUDE_X & LONGITUDE_X<= b[2]),
     "2" = ( a[1] <= LATITUDE_X & LATITUDE_X <= a[2] & b[2] < LONGITUDE_X & LONGITUDE_X <= b[3]),
     "3" = ( a[1] <= LATITUDE_X & LATITUDE_X <= a[2] & b[3] < LONGITUDE_X & LONGITUDE_X<= b[4]),
     "4" = ( a[1] <= LATITUDE_X & LATITUDE_X <= a[2] & b[4] < LONGITUDE_X & LONGITUDE_X <= b[5]),
     "5" = ( a[1] <= LATITUDE_X & LATITUDE_X <= a[2] & b[5] < LONGITUDE_X & LONGITUDE_X<= b[6]),
     "6" = ( a[1] <= LATITUDE_X & LATITUDE_X <= a[2] & b[6] < LONGITUDE_X & LONGITUDE_X <= b[7]),
     "7" = ( a[1] <= LATITUDE_X & LATITUDE_X <= a[2] & b[7] < LONGITUDE_X & LONGITUDE_X<= b[8]),
     "8" = ( a[1] <= LATITUDE_X & LATITUDE_X <= a[2] & b[8] < LONGITUDE_X & LONGITUDE_X <= b[9]),
     "9" = ( a[1] <= LATITUDE_X & LATITUDE_X <= a[2] & b[9] < LONGITUDE_X & LONGITUDE_X<= b[10]),
     "10" = ( a[1] <= LATITUDE_X & LATITUDE_X <= a[2] & b[10] < LONGITUDE_X & LONGITUDE_X <= b[11]),
     
     
      "11" = ( a[2] < LATITUDE_X & LATITUDE_X <= a[3] & b[1] < LONGITUDE_X & LONGITUDE_X<= b[2]),
     "12" = ( a[2] < LATITUDE_X & LATITUDE_X <= a[3] & b[2] < LONGITUDE_X & LONGITUDE_X <= b[3]),
     "13" = ( a[2] < LATITUDE_X & LATITUDE_X <= a[3] & b[3] < LONGITUDE_X & LONGITUDE_X<= b[4]),
     "14" = ( a[2] < LATITUDE_X & LATITUDE_X <= a[3] & b[4] < LONGITUDE_X & LONGITUDE_X <= b[5]),
     "15" = ( a[2] < LATITUDE_X & LATITUDE_X <= a[3] & b[5] < LONGITUDE_X & LONGITUDE_X<= b[6]),
     "16" = ( a[2] < LATITUDE_X & LATITUDE_X <= a[3] & b[6] < LONGITUDE_X & LONGITUDE_X <= b[7]),
     "17" = ( a[2] < LATITUDE_X & LATITUDE_X <= a[3] & b[7] < LONGITUDE_X & LONGITUDE_X<= b[8]),
     "18" = ( a[2] < LATITUDE_X & LATITUDE_X <= a[3] & b[8] < LONGITUDE_X & LONGITUDE_X <= b[9]),
     "19" = ( a[2] < LATITUDE_X & LATITUDE_X <= a[3] & b[9] < LONGITUDE_X & LONGITUDE_X<= b[10]),
     "20" = ( a[2] < LATITUDE_X & LATITUDE_X <= a[3] & b[10] < LONGITUDE_X & LONGITUDE_X <= b[11]),
     
     
     "21" = ( a[3] < LATITUDE_X & LATITUDE_X <= a[4] & b[1] < LONGITUDE_X & LONGITUDE_X<= b[2]),
     "22" = ( a[3] < LATITUDE_X & LATITUDE_X <= a[4] & b[2] < LONGITUDE_X & LONGITUDE_X <= b[3]),
     "23" = ( a[3] < LATITUDE_X & LATITUDE_X <= a[4] & b[3] < LONGITUDE_X & LONGITUDE_X<= b[4]),
     "24" = ( a[3] < LATITUDE_X & LATITUDE_X <= a[4] & b[4] < LONGITUDE_X & LONGITUDE_X <= b[5]),
     "25" = ( a[3] < LATITUDE_X & LATITUDE_X <= a[4] & b[5] < LONGITUDE_X & LONGITUDE_X<= b[6]),
     "26" = ( a[3] < LATITUDE_X & LATITUDE_X <= a[4] & b[6] < LONGITUDE_X & LONGITUDE_X <= b[7]),
     "27" = ( a[3] < LATITUDE_X & LATITUDE_X <= a[4] & b[7] < LONGITUDE_X & LONGITUDE_X<= b[8]),
     "28" = ( a[3] < LATITUDE_X & LATITUDE_X <= a[4] & b[8] < LONGITUDE_X & LONGITUDE_X <= b[9]),
     "29" = ( a[3] < LATITUDE_X & LATITUDE_X <= a[4] & b[9] < LONGITUDE_X & LONGITUDE_X<= b[10]),
     "30" = ( a[3] < LATITUDE_X & LATITUDE_X <= a[4] & b[10] < LONGITUDE_X & LONGITUDE_X <= b[11]),
    
     "31" = ( a[4] < LATITUDE_X & LATITUDE_X <= a[5] & b[1] < LONGITUDE_X & LONGITUDE_X<= b[2]),
     "32" = ( a[4] < LATITUDE_X & LATITUDE_X <= a[5] & b[2] < LONGITUDE_X & LONGITUDE_X <= b[3]),
     "33" = ( a[4] < LATITUDE_X & LATITUDE_X <= a[5] & b[3] < LONGITUDE_X & LONGITUDE_X<= b[4]),
     "34" = ( a[4] < LATITUDE_X & LATITUDE_X <= a[5] & b[4] < LONGITUDE_X & LONGITUDE_X <= b[5]),
     "35" = ( a[4] < LATITUDE_X & LATITUDE_X <= a[5] & b[5] < LONGITUDE_X & LONGITUDE_X<= b[6]),
     "36" = ( a[4] < LATITUDE_X & LATITUDE_X <= a[5] & b[6] < LONGITUDE_X & LONGITUDE_X <= b[7]),
     "37" = ( a[4] < LATITUDE_X & LATITUDE_X <= a[5] & b[7] < LONGITUDE_X & LONGITUDE_X<= b[8]),
     "38" = ( a[4] < LATITUDE_X & LATITUDE_X <= a[5] & b[8] < LONGITUDE_X & LONGITUDE_X <= b[9]),
     "39" = ( a[4] < LATITUDE_X & LATITUDE_X <= a[5] & b[9] < LONGITUDE_X & LONGITUDE_X<= b[10]),
     "40" = ( a[4] < LATITUDE_X & LATITUDE_X <= a[5] & b[10] < LONGITUDE_X & LONGITUDE_X <= b[11]),
     
     "41" = ( a[5] < LATITUDE_X & LATITUDE_X <= a[6] & b[1] < LONGITUDE_X & LONGITUDE_X<= b[2]),
     "42" = ( a[5] < LATITUDE_X & LATITUDE_X <= a[6] & b[2] < LONGITUDE_X & LONGITUDE_X <= b[3]),
     "43" = ( a[5] < LATITUDE_X & LATITUDE_X <= a[6] & b[3] < LONGITUDE_X & LONGITUDE_X<= b[5]),
     "44" = ( a[5] < LATITUDE_X & LATITUDE_X <= a[6] & b[4] < LONGITUDE_X & LONGITUDE_X <= b[5]),
     "45" = ( a[5] < LATITUDE_X & LATITUDE_X <= a[6] & b[5] < LONGITUDE_X & LONGITUDE_X<= b[5]),
     "46" = ( a[5] < LATITUDE_X & LATITUDE_X <= a[6] & b[6] < LONGITUDE_X & LONGITUDE_X <= b[7]),
     "47" = ( a[5] < LATITUDE_X & LATITUDE_X <= a[6] & b[7] < LONGITUDE_X & LONGITUDE_X<= b[8]),
     "48" = ( a[5] < LATITUDE_X & LATITUDE_X <= a[6] & b[8] < LONGITUDE_X & LONGITUDE_X <= b[9]),
     "49" = ( a[5] < LATITUDE_X & LATITUDE_X <= a[6] & b[9] < LONGITUDE_X & LONGITUDE_X<= b[10]),
     "50" = ( a[5] < LATITUDE_X & LATITUDE_X <= a[6] & b[10] < LONGITUDE_X & LONGITUDE_X <= b[11]),
     
     "51" = ( a[6] < LATITUDE_X & LATITUDE_X <= a[7] & b[1] < LONGITUDE_X & LONGITUDE_X<= b[2]),
     "52" = ( a[6] < LATITUDE_X & LATITUDE_X <= a[7] & b[2] < LONGITUDE_X & LONGITUDE_X <= b[3]),
     "53" = ( a[6] < LATITUDE_X & LATITUDE_X <= a[7] & b[3] < LONGITUDE_X & LONGITUDE_X<= b[5]),
     "54" = ( a[6] < LATITUDE_X & LATITUDE_X <= a[7] & b[4] < LONGITUDE_X & LONGITUDE_X <= b[5]),
     "55" = ( a[6] < LATITUDE_X & LATITUDE_X <= a[7] & b[5] < LONGITUDE_X & LONGITUDE_X<= b[5]),
     "56" = ( a[6] < LATITUDE_X & LATITUDE_X <= a[7] & b[6] < LONGITUDE_X & LONGITUDE_X <= b[7]),
     "57" = ( a[6] < LATITUDE_X & LATITUDE_X <= a[7] & b[7] < LONGITUDE_X & LONGITUDE_X<= b[8]),
     "58" = ( a[6] < LATITUDE_X & LATITUDE_X <= a[7] & b[8] < LONGITUDE_X & LONGITUDE_X <= b[9]),
     "59" = ( a[6] < LATITUDE_X & LATITUDE_X <= a[7] & b[9] < LONGITUDE_X & LONGITUDE_X<= b[10]),
     "60" = ( a[6] < LATITUDE_X & LATITUDE_X <= a[7] & b[10] < LONGITUDE_X & LONGITUDE_X <= b[11]),
     
     "61" = ( a[7] < LATITUDE_X & LATITUDE_X <= a[8] & b[1] < LONGITUDE_X & LONGITUDE_X<= b[2]),
     "62" = ( a[7] < LATITUDE_X & LATITUDE_X <= a[8] & b[2] < LONGITUDE_X & LONGITUDE_X <= b[3]),
     "63" = ( a[7] < LATITUDE_X & LATITUDE_X <= a[8] & b[3] < LONGITUDE_X & LONGITUDE_X<= b[5]),
     "64" = ( a[7] < LATITUDE_X & LATITUDE_X <= a[8] & b[4] < LONGITUDE_X & LONGITUDE_X <= b[5]),
     "65" = ( a[7] < LATITUDE_X & LATITUDE_X <= a[8] & b[5] < LONGITUDE_X & LONGITUDE_X<= b[5]),
     "66" = ( a[7] < LATITUDE_X & LATITUDE_X <= a[8] & b[6] < LONGITUDE_X & LONGITUDE_X <= b[7]),
     "67" = ( a[7] < LATITUDE_X & LATITUDE_X <= a[8] & b[7] < LONGITUDE_X & LONGITUDE_X<= b[8]),
     "68" = ( a[7] < LATITUDE_X & LATITUDE_X <= a[8] & b[8] < LONGITUDE_X & LONGITUDE_X <= b[9]),
     "69" = ( a[7] < LATITUDE_X & LATITUDE_X <= a[8] & b[9] < LONGITUDE_X & LONGITUDE_X<= b[10]),
     "70" = ( a[7] < LATITUDE_X & LATITUDE_X <= a[8] & b[10] < LONGITUDE_X & LONGITUDE_X <= b[11]),
     
     "71" = ( a[8] < LATITUDE_X & LATITUDE_X <= a[9] & b[1] < LONGITUDE_X & LONGITUDE_X<= b[2]),
     "72" = ( a[8] < LATITUDE_X & LATITUDE_X <= a[9] & b[2] < LONGITUDE_X & LONGITUDE_X <= b[3]),
     "73" = ( a[8] < LATITUDE_X & LATITUDE_X <= a[9] & b[3] < LONGITUDE_X & LONGITUDE_X<= b[5]),
     "74" = ( a[8] < LATITUDE_X & LATITUDE_X <= a[9] & b[4] < LONGITUDE_X & LONGITUDE_X <= b[5]),
     "75" = ( a[8] < LATITUDE_X & LATITUDE_X <= a[9] & b[5] < LONGITUDE_X & LONGITUDE_X<= b[5]),
     "76" = ( a[8] < LATITUDE_X & LATITUDE_X <= a[9] & b[6] < LONGITUDE_X & LONGITUDE_X <= b[7]),
     "77" = ( a[8] < LATITUDE_X & LATITUDE_X <= a[9] & b[7] < LONGITUDE_X & LONGITUDE_X<= b[8]),
     "78" = ( a[8] < LATITUDE_X & LATITUDE_X <= a[9] & b[8] < LONGITUDE_X & LONGITUDE_X <= b[9]),
     "79" = ( a[8] < LATITUDE_X & LATITUDE_X <= a[9] & b[9] < LONGITUDE_X & LONGITUDE_X<= b[10]),
     "80" = ( a[8] < LATITUDE_X & LATITUDE_X <= a[9] & b[10] < LONGITUDE_X & LONGITUDE_X <= b[11]),
     
     "81" = ( a[9] < LATITUDE_X & LATITUDE_X <= a[10] & b[1] < LONGITUDE_X & LONGITUDE_X<= b[2]),
     "82" = ( a[9] < LATITUDE_X & LATITUDE_X <= a[10] & b[2] < LONGITUDE_X & LONGITUDE_X <= b[3]),
     "83" = ( a[9] < LATITUDE_X & LATITUDE_X <= a[10] & b[3] < LONGITUDE_X & LONGITUDE_X<= b[5]),
     "84" = ( a[9] < LATITUDE_X & LATITUDE_X <= a[10] & b[4] < LONGITUDE_X & LONGITUDE_X <= b[5]),
     "85" = ( a[9] < LATITUDE_X & LATITUDE_X <= a[10] & b[5] < LONGITUDE_X & LONGITUDE_X<= b[5]),
     "86" = ( a[9] < LATITUDE_X & LATITUDE_X <= a[10] & b[6] < LONGITUDE_X & LONGITUDE_X <= b[7]),
     "87" = ( a[9] < LATITUDE_X & LATITUDE_X <= a[10] & b[7] < LONGITUDE_X & LONGITUDE_X<= b[8]),
     "88" = ( a[9] < LATITUDE_X & LATITUDE_X <= a[10] & b[8] < LONGITUDE_X & LONGITUDE_X <= b[9]),
     "89" = ( a[9] < LATITUDE_X & LATITUDE_X <= a[10] & b[9] < LONGITUDE_X & LONGITUDE_X<= b[10]),
     "90" = ( a[9] < LATITUDE_X & LATITUDE_X <= a[10] & b[10] < LONGITUDE_X & LONGITUDE_X <= b[11]),
     
     "91" = ( a[10] < LATITUDE_X & LATITUDE_X <= a[11] & b[1] < LONGITUDE_X & LONGITUDE_X<= b[2]),
     "92" = ( a[10] < LATITUDE_X & LATITUDE_X <= a[11] & b[2] < LONGITUDE_X & LONGITUDE_X <= b[3]),
     "93" = ( a[10] < LATITUDE_X & LATITUDE_X <= a[11] & b[3] < LONGITUDE_X & LONGITUDE_X<= b[5]),
     "94" = ( a[10] < LATITUDE_X & LATITUDE_X <= a[11] & b[4] < LONGITUDE_X & LONGITUDE_X <= b[5]),
     "95" = ( a[10] < LATITUDE_X & LATITUDE_X <= a[11] & b[5] < LONGITUDE_X & LONGITUDE_X<= b[5]),
     "96" = ( a[10] < LATITUDE_X & LATITUDE_X <= a[11] & b[6] < LONGITUDE_X & LONGITUDE_X <= b[7]),
     "97" = ( a[10] < LATITUDE_X & LATITUDE_X <= a[11] & b[7] < LONGITUDE_X & LONGITUDE_X<= b[8]),
     "98" = ( a[10] < LATITUDE_X & LATITUDE_X <= a[11] & b[8] < LONGITUDE_X & LONGITUDE_X <= b[9]),
     "99" = ( a[10] < LATITUDE_X & LATITUDE_X <= a[11] & b[9] < LONGITUDE_X & LONGITUDE_X<= b[10]),
     "100" = ( a[10] < LATITUDE_X & LATITUDE_X <= a[11] & b[10] < LONGITUDE_X & LONGITUDE_X <= b[11]),
     .method = "first",
     .default = NA
     ))
```

```{r}
summary(small_reg$region)
```
